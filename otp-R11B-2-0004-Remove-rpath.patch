From 6a80d8977bd84382e33cd4988910320b541c290d Mon Sep 17 00:00:00 2001
From: Peter Lemenkov <lemenkov@gmail.com>
Date: Mon, 19 Apr 2010 13:36:36 +0400
Subject: [PATCH 4/8] Remove rpath

---
 lib/crypto/c_src/Makefile.in |    2 +-
 lib/crypto/priv/Makefile     |    2 +-
 lib/ssl/c_src/Makefile.in    |    6 +++---
 3 files changed, 5 insertions(+), 5 deletions(-)

diff --git a/lib/crypto/c_src/Makefile.in b/lib/crypto/c_src/Makefile.in
index 70ebeb9..481277f 100644
--- a/lib/crypto/c_src/Makefile.in
+++ b/lib/crypto/c_src/Makefile.in
@@ -79,7 +79,7 @@ endif
 ifeq ($(HOST_OS),)
 HOST_OS := $(shell $(ERL_TOP)/erts/autoconf/config.guess)
 endif
-LD_R_FLAG=@DED_LD_FLAG_RUNTIME_LIBRARY_PATH@
+LD_R_FLAG=
 ifeq ($(strip $(LD_R_FLAG)),)
 LD_R_OPT =
 else
diff --git a/lib/crypto/priv/Makefile b/lib/crypto/priv/Makefile
index b8acdac..2c2989a 100644
--- a/lib/crypto/priv/Makefile
+++ b/lib/crypto/priv/Makefile
@@ -60,7 +60,7 @@ OBJS = $(OBJDIR)/crypto_drv.o
 # ----------------------------------------------------
 
 $(SO_DRIVER): $(OBJS)
-	$(SO_LD) $(SO_LDFLAGS) -L$(SO_SSL_LIBDIR) -Wl,-R$(SO_SSL_LIBDIR) \
+	$(SO_LD) $(SO_LDFLAGS) -L$(SO_SSL_LIBDIR) \
 	-o $@ $^ -lcrypto
 
 $(DLL_DRIVER): $(OBJS)
diff --git a/lib/ssl/c_src/Makefile.in b/lib/ssl/c_src/Makefile.in
index e6bf3c0..b145aac 100644
--- a/lib/ssl/c_src/Makefile.in
+++ b/lib/ssl/c_src/Makefile.in
@@ -95,7 +95,7 @@ SKIP_BUILDING_BINARIES := true
 endif
 endif
 
-CC_R_FLAG=@CFLAG_RUNTIME_LIBRARY_PATH@
+CC_R_FLAG=
 ifeq ($(findstring @,$(CC_R_FLAG)),@)
 # Old erts configure used which hasn't replaced @CFLAG_RUNTIME_LIBRARY_PATH@;
 # we try our best here instead...
@@ -104,9 +104,9 @@ ifeq ($(findstring darwin,$(TARGET)),darwin)	# darwin: no flag
 CC_R_FLAG =
 else
 ifeq ($(findstring osf,$(TARGET)),osf)		# osf1: -Wl,-rpath,
-CC_R_FLAG = -Wl,-rpath,
+CC_R_FLAG =
 else						# Default: -Wl,-R
-CC_R_FLAG = -Wl,-R
+CC_R_FLAG =
 endif
 endif
 
-- 
1.6.6.1

